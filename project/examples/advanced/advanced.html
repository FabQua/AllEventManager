<!DOCTYPE html>
<html>
    <head>
        <title>AllEventManager Advanced Example</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="text/css" rel="stylesheet" href="advanced.css" />
        <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="../../../dist/alleventmanager.min.js"></script>
        <script>
            function simulateAjaxRequest(request) {
                // imagine this method would do ajax requests and the response would be
                switch (request) {
                    case "addSquare":
                        (function () {
                            var content = $("#content");
                            var div = content.append("div");
                            div.addClass("square");
                            AllEventManager.dispatchEvent("contentchanged", {
                                title: "Login"
                            });
                        })();
                        break;
                    case "Form 2":
                        (function () {
                            AllEventManager.dispatchEvent("contentchanged", {
                                title: ""
                            });
                        })();
                        break;
                    case "Form 3":
                        (function () {
                            AllEventManager.dispatchEvent("contentchanged", {
                                title: ""
                            });
                        })();
                        break;
                    default:
                        (function () {
                            AllEventManager.dispatchEvent("contentchanged", {
                                title: ""
                            });
                        })();
                        break;
                }
            }

            function FontSize(domElement) {
                this.container = domElement;

                this.onFontSizeIncreased = function (event) {
                    var size = this.container.css("font-size") + 1;
                    this.container.css("font-size", size);
                    this.container.html("Fontsize: " + size);
                };
                this.onFontSizeDecreased = function (event) {
                    var size = this.container.css("font-size") - 1;
                    this.container.css("font-size", size);
                    this.container.html("Fontsize: " + size);
                };
                this.onSessionExpired = function (event) {
                    AllEventManager.unregister(this);
                };
            }

            function SessionTimer(domRTimer) {
                this.domRTimer = domRTimer;
                this.interval;
                this.sessionTime;
                this.setUpTimer = function (date) {
                    if (this.interval) {
                        clearInterval(this.interval);
                    } else {
                        setInterval(function () {

                        });
                    }
                };
                this.onTimerUpdated = function (event) {
                    var data = event.getData();

                    this.setUpTimer(data.time);
                };
                this.onSessionExpired = function (event) {
                    if (this.interval) {
                        clearInterval(this.interval);
                    }
                    AllEventManager.unregister(this);
                };
            }

            function Site() {
                this.init = function () {
                    var hTitle = new HFontSize();
                    var hTimer = new SessionTimer();

                    AllEventManager.register(this);
                    AllEventManager.register(hTitle, "header");
                    AllEventManager.register(hTimer, "header");
                };
                this.logout = function () {
                    // do logout
                };
                this.simulateAjaxRequest = function (action) {
                };
                this.onMenuEntrySwitched = function (event) {
                    var data = event.getData();

                    this.simulateAjaxRequest(data.name);
                };
                this.onSessionExpired = function (event) {
                    AllEventManager.unregister(this);
                    this.logout();
                };
            }

            $(document).ready(function () {

            });
        </script>
    </head>
    <body>
        <div class="container header">
            <span id="fontsize">
                Fontsize: 11
            </span>
            <div id="timer_container">
                Session expired in <span id="timer">00:00:00</span>
            </div>
        </div>
        <div>
            <div id="menu">
                <div class="header">
                    Square
                </div>
                <div class="entry" onclick="simulateAjaxRequest('addSquare')">
                    Add
                </div>
                <div class="header">
                    Fontsize
                </div>
                <div class="sub">
                    Global
                </div>
                <div>
                    <div class="half">
                        <div class="entry" onclick="simulateAjaxRequest('globalDecrease')">
                            -
                        </div>
                    </div>
                    <div class="half">
                        <div class="entry" onclick="simulateAjaxRequest('globalIncrease')">
                            +
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="sub">
                    Content
                </div>
                <div>
                    <div class="half">
                        <div class="entry" onclick="simulateAjaxRequest('contentDecrease')">
                            -
                        </div>
                    </div>
                    <div class="half">
                        <div class="entry" onclick="simulateAjaxRequest('globalIncrease')">
                            +
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div id="content"></div>
            <div class="clear">

            </div>
        </div>
    </body>
</html>
